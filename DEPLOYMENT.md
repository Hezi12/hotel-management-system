# מדריך פריסה והעלאה לשרת חיצוני

## תוכן עניינים
1. [הכנת הפרויקט לפריסה](#הכנת-הפרויקט-לפריסה)
2. [העלאת הקליינט ל-Vercel](#העלאת-הקליינט-ל-vercel)
3. [העלאת השרת ל-Render](#העלאת-השרת-ל-render)
4. [חיבור הקליינט והשרת](#חיבור-הקליינט-והשרת)
5. [בדיקת המערכת](#בדיקת-המערכת)
6. [פתרון בעיות נפוצות](#פתרון-בעיות-נפוצות)

## הכנת הפרויקט לפריסה

### 1. וידוא קבצי סביבה
וודא שקבצי הסביבה הבאים קיימים ומוגדרים נכון:

**קליינט** (`.env.production`):
```
NEXT_PUBLIC_API_URL=https://[שם-השרת-שלך].onrender.com
NEXT_PUBLIC_SITE_URL=https://[שם-האתר-שלך].vercel.app
```

**שרת** (`.env.production`):
```
MONGO_URI=mongodb+srv://[שם-משתמש]:[סיסמה]@cluster0.v5l4f.mongodb.net/hotel-management?retryWrites=true&w=majority
PORT=5001
JWT_SECRET=[מפתח-סודי-שלך]
NODE_ENV=production
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=[כתובת-המייל-שלך]@gmail.com
EMAIL_PASS=[סיסמת-האפליקציה]
CLIENT_URL=https://[שם-האתר-שלך].vercel.app
JWT_EXPIRE=30d
```

### 2. בניית גרסת ייצור של הקליינט
```bash
cd client
npm run build
```

## העלאת הקליינט ל-Vercel

מכיוון שכבר יש לך חשבון Vercel, הנה השלבים להעלאת הקליינט:

1. **התחברות לחשבון Vercel שלך**

2. **יצירת פרויקט חדש**:
   - לחץ על "Add New" ובחר "Project"
   - חבר את מאגר ה-GitHub שלך או העלה את הקוד ישירות

3. **הגדרת הפרויקט**:
   - בחר את תיקיית `client` כתיקיית הבסיס של הפרויקט
   - וודא שהפקודה לבנייה היא `npm run build`
   - הוסף את משתני הסביבה הבאים:
     ```
     NEXT_PUBLIC_API_URL=https://[שם-השרת-שלך].onrender.com
     NEXT_PUBLIC_SITE_URL=https://[שם-האתר-שלך].vercel.app
     ```

4. **לחץ על "Deploy"** והמתן להשלמת הפריסה

5. **שמור את כתובת ה-URL** שנוצרה עבור האתר שלך (תצטרך אותה להגדרת השרת)

## העלאת השרת ל-Render

1. **הירשם/התחבר ל-Render**: [https://render.com](https://render.com)

2. **צור שירות חדש**:
   - לחץ על "New" ובחר "Web Service"
   - חבר את מאגר ה-GitHub שלך או העלה את הקוד ישירות

3. **הגדרת השירות**:
   - שם: `hotel-management-server` (או שם אחר לבחירתך)
   - תיקיית בסיס: `server`
   - פקודת בנייה: `npm install`
   - פקודת הפעלה: `node server.js`
   - בחר תוכנית חינמית או בתשלום לפי הצורך

4. **הוסף משתני סביבה**:
   - העתק את כל המשתנים מקובץ `.env.production` של השרת
   - וודא שהגדרת את `CLIENT_URL` לכתובת ה-Vercel שקיבלת בשלב הקודם
   - וודא שהגדרת `NODE_ENV=production`

5. **לחץ על "Create Web Service"** והמתן להשלמת הפריסה

6. **שמור את כתובת ה-URL** של השרת

## חיבור הקליינט והשרת

לאחר שהעלית את הקליינט והשרת, עליך לוודא שהם מקושרים כראוי:

1. **עדכן את הגדרות הקליינט ב-Vercel**:
   - עבור להגדרות הפרויקט ב-Vercel
   - עדכן את משתנה הסביבה `NEXT_PUBLIC_API_URL` לכתובת השרת שלך ב-Render
   - לחץ על "Redeploy" כדי להחיל את השינויים

2. **עדכן את הגדרות השרת ב-Render**:
   - עבור להגדרות השירות ב-Render
   - עדכן את משתנה הסביבה `CLIENT_URL` לכתובת הקליינט שלך ב-Vercel
   - לחץ על "Save Changes" ו"Manual Deploy" > "Deploy latest commit"

## בדיקת המערכת

לאחר השלמת הפריסה, בדוק את המערכת:

1. **בדוק את הקליינט**:
   - גלוש לכתובת ה-Vercel שלך
   - וודא שהממשק נטען כראוי
   - נסה להירשם או להתחבר

2. **בדוק את השרת**:
   - גלוש לכתובת ה-Render שלך בתוספת `/api` (לדוגמה: `https://[שם-השרת-שלך].onrender.com/api`)
   - וודא שאתה מקבל תשובת JSON תקינה

3. **בדוק את התקשורת בין הקליינט לשרת**:
   - נסה לבצע פעולות שדורשות תקשורת עם השרת (כמו חיפוש חדרים או הזמנה)

## פתרון בעיות נפוצות

### בעיות CORS
אם אתה נתקל בשגיאות CORS, וודא שהשרת מוגדר לאפשר בקשות מהדומיין של הקליינט:
- בדוק את הגדרות ה-CORS בקובץ `server.js`
- וודא שהגדרת נכון את `CLIENT_URL` בהגדרות השרת

### בעיות חיבור לבסיס הנתונים
- וודא שמחרוזת החיבור ל-MongoDB תקינה
- בדוק שהכתובת IP של השרת ב-Render מורשית בהגדרות האבטחה של MongoDB Atlas

### בעיות תצוגה בקליינט
- בדוק את לוגים של הקליינט ב-Vercel
- וודא שהגדרת נכון את `NEXT_PUBLIC_API_URL`

### שגיאות בשרת
- בדוק את הלוגים של השרת ב-Render
- וודא שכל התלויות הותקנו כראוי

---

זכור שבסביבת הייצור, השינויים לא מתעדכנים אוטומטית כמו בסביבת הפיתוח. לאחר כל שינוי בקוד, עליך לבנות מחדש ולפרוס את האפליקציה.

אם אתה נתקל בבעיות נוספות, בדוק את התיעוד הרשמי של [Vercel](https://vercel.com/docs) ו-[Render](https://render.com/docs) או פנה לקהילת המפתחים לעזרה. 